import{d as e,r as a,c as l,o as t,w as o,a as r,u,C as n,b as s,e as i,f as c,g as v,s as d,h as p,i as m,j as f,k as y,l as h,m as g,n as k,p as _,t as E,S as w,T as b,q as C,B as P,P as j,L as T,F as $,v as S,I as V,x,y as z,z as L,A,D as O,E as U}from"./chunk--rGzKqVA.js";const N={},I=function(e,a,l){let t=Promise.resolve();if(a&&a.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),o=(null==l?void 0:l.nonce)||(null==l?void 0:l.getAttribute("nonce"));t=e(a.map(e=>{if((e=function(e){return"/audio-book/"+e}(e))in N)return;N[e]=!0;const a=e.endsWith(".css"),l=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${l}`))return;const t=document.createElement("link");return t.rel=a?"stylesheet":"modulepreload",a||(t.as="script"),t.crossOrigin="",t.href=e,o&&t.setAttribute("nonce",o),document.head.appendChild(t),a?new Promise((a,l)=>{t.addEventListener("load",a),t.addEventListener("error",()=>l(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function o(e){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=e,window.dispatchEvent(a),!a.defaultPrevented)throw e}return t.then(a=>{for(const e of a||[])"rejected"===e.status&&o(e.reason);return e().catch(o)})},R=[{path:"/",name:"/",component:()=>I(()=>Promise.resolve().then(()=>je),void 0)},{path:"/:all(.*)",name:"/[...all]",component:()=>I(()=>Promise.resolve().then(()=>$e),void 0)}],B={buttonPrimaryBackground:"#EA6853",buttonPrimaryBorderColor:"#EA6853",buttonDefaultHeight:"0.8rem",buttonNormalFontSize:"0.26rem",buttonRadius:"0.1rem",cellLineHeight:"0.65rem",sliderBarHeight:"4px"},F=s(e({__name:"App",setup:e=>(e,s)=>{const i=a("RouterView"),c=n;return t(),l(c,{"theme-vars":u(B)},{default:o(()=>[r(i)]),_:1},8,["theme-vars"])}})),q=i({routes:R,history:c()});F.use(q),F.mount("#app");const D=v.create({baseURL:void 0,timeout:15e3,headers:{"Content-Type":"application/json;charset=UTF-8"}});D.interceptors.request.use(e=>e,e=>Promise.reject(e)),D.interceptors.response.use(e=>{const a=e.data,l=!1!==e.config.showError;return a.code&&200!==a.code?(a.code,l&&d(a.msg||"Error"),Promise.reject(new Error(a.msg||"Error"))):200!==e.status?(l&&d(a.msg||"Network Error"),Promise.reject(new Error(a.msg||"Network Error"))):a},e=>{var a,l,t;if(!1!==(null==(a=e.config)?void 0:a.showError)){const a=(null==(t=null==(l=e.response)?void 0:l.data)?void 0:t.msg)||e.message||"Network Error";d(a)}return Promise.reject(e)});const M={get(e){const{url:a,params:l,config:t,showError:o=!0}=e,r={params:l,showError:o,...t};return D.get(a,r)},post(e){const{url:a,data:l,config:t,showError:o=!0}=e,r={showError:o,...t};return D.post(a,l,r)},put(e){const{url:a,data:l,config:t,showError:o=!0}=e,r={showError:o,...t};return D.put(a,l,r)},delete(e){const{url:a,params:l,config:t,showError:o=!0}=e,r={params:l,showError:o,...t};return D.delete(a,r)}};function W(){return M.get({url:`${"/audio-book".endsWith("/")?"/audio-book".slice(0,-1):"/audio-book"}/json/all.json`,showError:!1})}function H(e){switch(e){case"all":default:return W();case"local":return M.get({url:`${"/audio-book".endsWith("/")?"/audio-book".slice(0,-1):"/audio-book"}/json/local.json`,showError:!1});case"voice":return M.get({url:`${"/audio-book".endsWith("/")?"/audio-book".slice(0,-1):"/audio-book"}/json/voice.json`,showError:!1})}}const G={class:"audio-playlist"},J={class:"search-section"},K={class:"playlist-selector"},Q={key:0,class:"current-player"},X={class:"player-info"},Y={class:"cover"},Z=["src","alt"],ee={key:1,class:"default-cover"},ae={class:"info"},le={class:"title"},te={class:"artist"},oe={class:"progress-section"},re={class:"time"},ue={class:"time"},ne={class:"controls"},se={class:"volume-section"},ie={class:"loop-selector"},ce={class:"loop-selector-header"},ve={class:"loop-options"},de={class:"loop-status"},pe={key:0},me={class:"current-status"},fe={class:"playlist-section"},ye={class:"playlist-header"},he={class:"song-info"},ge={class:"song-title"},ke={class:"song-artist"},_e={class:"flex items-center"},Ee=(e,a)=>{const l=e.__vccOpts||e;for(const[t,o]of a)l[t]=o;return l},we=Ee(e({__name:"AudioPlaylist",props:{playlist:null,currentPlaylistType:null},emits:["playlistChange"],setup(e,{emit:a}){const u=e,n=a,s=[{text:"全部故事",value:"all"},{text:"本地故事",value:"local"},{text:"人声故事",value:"voice"}],i=p(u.currentPlaylistType||"all"),c=p(""),v=p(""),O=p(0),U=p(!1),N=p(0),I=p(0),R=p(!1),B=p(100),F=p(!1),q=p(),D=p(1),M=p(0),W=p(!1),H=m(()=>{if(!v.value.trim())return u.playlist;const e=v.value.toLowerCase();return u.playlist.filter(a=>a.title.toLowerCase().includes(e)||a.sort===Number(e))}),Ee=m(()=>H.value[O.value]||null),we=p(0),be=m(()=>0===D.value?"单曲无限循环":1===D.value?"播放一次":`单曲循环 ${M.value+1}/${D.value}`);function Ce(e){return`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`}async function Pe(){if(q.value&&Ee.value)try{F.value=!0,await q.value.play(),U.value=!0}catch(e){d("播放失败")}finally{F.value=!1}}function je(){q.value&&(q.value.pause(),U.value=!1)}function Te(){U.value?je():Pe()}function $e(){O.value<H.value.length-1?O.value++:O.value=0,Le(),Pe()}function Se(){O.value>0?O.value--:O.value=H.value.length-1,Le(),Pe()}function Ve(){R.value=!R.value,q.value&&(q.value.loop=R.value)}function xe(){W.value=!W.value}function ze(){M.value=0}function Le(){if(q.value){q.value.currentTime=0,q.value.pause();let e="";"all"===i.value?e="https://kuer.77188.com/attachment/":"local"===i.value?e="":"voice"===i.value&&(e="http://hingsen.com/yinpinFirst23/videos/"),q.value.src=`${e}${Ee.value.src}`}}function Ae(e){if(!q.value)return;const a=e/100*I.value;q.value.currentTime=a}function Oe(e){q.value&&(q.value.volume=e/100)}function Ue(){q.value&&(I.value=q.value.duration)}function Ne(){q.value&&(N.value=q.value.currentTime,we.value=I.value>0?N.value/I.value*100:0)}function Ie(){if(U.value=!1,!R.value){if(0===D.value)return M.value++,void Pe();if(M.value<D.value-1)return M.value++,void Pe();ze(),$e()}}function Re(){F.value=!1,U.value=!1,d("音频加载失败")}function Be(){F.value=!1}function Fe(){O.value=0,v.value=c.value,ze(),Le(),Pe()}function qe(e){i.value=e,n("playlistChange",e),O.value=0,v.value="",c.value="",ze(),je()}return f(Ee,e=>{e&&q.value&&(N.value=0,I.value=0)},{immediate:!0}),f(()=>u.currentPlaylistType,e=>{e&&e!==i.value&&(i.value=e)},{immediate:!0}),y(()=>{q.value&&(q.value.volume=B.value/100,Le())}),h(()=>{q.value&&q.value.pause()}),(e,a)=>{const u=w,n=z,v=b,p=V,m=C,f=P,y=j,h=L,je=T;return t(),g("div",G,[k("div",J,[r(u,{modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=e=>c.value=e),placeholder:"搜索故事名或序号",onSearch:Fe},null,8,["modelValue"])]),k("div",K,[r(v,{active:i.value,"onUpdate:active":a[1]||(a[1]=e=>i.value=e),onChange:qe},{default:o(()=>[(t(),g($,null,S(s,e=>r(n,{key:e.value,name:e.value,title:e.text},null,8,["name","title"])),64))]),_:1},8,["active"])]),Ee.value?(t(),g("div",Q,[k("div",X,[k("div",Y,[Ee.value.cover?(t(),g("img",{key:0,src:Ee.value.cover,alt:Ee.value.title},null,8,Z)):(t(),g("div",ee,[r(p,{name:"music-o",size:"40"})]))]),k("div",ae,[k("div",le,E(Ee.value.title),1),k("div",te," 第"+E(Ee.value.sort)+"页 ",1)])]),k("div",oe,[k("span",re,E(Ce(N.value)),1),r(m,{modelValue:we.value,"onUpdate:modelValue":a[2]||(a[2]=e=>we.value=e),class:"progress-slider",onChange:Ae},null,8,["modelValue"]),k("span",ue,E(Ce(I.value)),1)]),k("div",ne,[r(f,{icon:"arrow-left",round:"",onClick:Se}),r(f,{icon:F.value?"loading":U.value?"pause":"play",round:"",type:"primary",loading:F.value,onClick:Te},null,8,["icon","loading"]),r(f,{icon:"arrow",round:"",onClick:$e}),r(f,{icon:"replay",type:R.value?"primary":"default",round:"",onClick:Ve},null,8,["type"]),r(f,{icon:"orders-o",type:1!==D.value?"primary":"default",round:"",onClick:xe},{default:o(()=>[x(E(0===D.value?"∞":D.value),1)]),_:1},8,["type"])]),k("div",se,[r(p,{size:"0.4rem",name:"volume-o"}),r(m,{modelValue:B.value,"onUpdate:modelValue":a[3]||(a[3]=e=>B.value=e),class:"volume-slider",onChange:Oe},null,8,["modelValue"])]),r(y,{show:W.value,"onUpdate:show":a[5]||(a[5]=e=>W.value=e),position:"bottom",style:{height:"40%"}},{default:o(()=>[k("div",ie,[k("div",ce,[a[7]||(a[7]=k("h3",null,"选择循环次数",-1)),r(f,{type:"primary",size:"small",onClick:a[4]||(a[4]=e=>W.value=!1)},{default:o(()=>a[6]||(a[6]=[x(" 完成 ")])),_:1,__:[6]})]),k("div",ve,[(t(),g($,null,S([1,2,3,5,10,0],e=>r(f,{key:e,type:D.value===e?"primary":"default",class:"loop-option",onClick:a=>function(e){D.value=e,M.value=0,W.value=!1,(e>1||0===e)&&(R.value=!1,q.value&&(q.value.loop=!1)),d(0===e?"设置为无限循环":`设置循环 ${e} 次`)}(e)},{default:o(()=>[x(E(0===e?"无限循环":`${e} 次`),1)]),_:2},1032,["type","onClick"])),64))]),k("div",de,[k("p",null,"当前设置: "+E(0===D.value?"无限循环":`循环 ${D.value} 次`),1),D.value>0?(t(),g("p",pe," 已完成: "+E(M.value+1)+" / "+E(D.value),1)):_("",!0),k("p",me," 状态: "+E(be.value),1)])])]),_:1},8,["show"])])):_("",!0),k("div",fe,[k("div",ye,[k("h3",null,"播放列表 ("+E(H.value.length)+")",1)]),r(je,{class:"playlist"},{default:o(()=>[(t(!0),g($,null,S(H.value,(e,a)=>(t(),l(h,{key:a,class:A({active:e.sort===Ee.value.sort}),clickable:"",onClick:e=>function(e){O.value=e,I.value=0,N.value=0,ze(),Le(),Pe()}(a)},{title:o(()=>[k("div",he,[k("div",ge,[x(E(e.title)+" ",1),k("span",ke,"（第"+E(e.sort)+"页）",1),e.sort===Ee.value.sort&&U.value?(t(),l(p,{key:0,name:"volume",color:"#1989fa"})):_("",!0)])])]),"right-icon":o(()=>[k("div",_e,[e.sort===Ee.value.sort&&U.value?(t(),l(p,{key:0,color:"#1989fa",size:"0.35rem",name:"pause-circle-o"})):(t(),l(p,{key:1,size:"0.35rem",name:"play-circle-o"}))])]),_:2},1032,["class","onClick"]))),128))]),_:1})]),k("audio",{ref_key:"audioRef",ref:q,preload:"metadata",onLoadedmetadata:Ue,onTimeupdate:Ne,onEnded:Ie,onError:Re,onCanplay:Be},null,544)])}}}),[["__scopeId","data-v-70189fb4"]]),be={key:0,class:"loading-container"},Ce={key:2,class:"empty-container"},Pe=Ee(e({name:"IndexPage",__name:"index",setup(e){const a=p([]),n=p("all"),s=p(!1);async function i(e="all"){try{s.value=!0;const l=(await H(e)).data.map((e,a)=>({sort:a+1,title:e.title,src:e.src,cover:e.cover}));a.value=l,n.value=e}catch(l){}finally{s.value=!1}}function c(e){i(e)}return y(()=>{i("all")}),(e,i)=>{const v=O,d=U;return u(s)?(t(),g("div",be,[r(v,{type:"spinner",size:"24px"},{default:o(()=>i[0]||(i[0]=[x(" 加载中... ")])),_:1,__:[0]})])):u(a).length?(t(),l(we,{key:1,playlist:u(a),"current-playlist-type":u(n),onPlaylistChange:c},null,8,["playlist","current-playlist-type"])):(t(),g("div",Ce,[r(d,{description:"暂无音频数据"})]))}}}),[["__scopeId","data-v-f79be702"]]),je=Object.freeze(Object.defineProperty({__proto__:null,default:Pe},Symbol.toStringTag,{value:"Module"}));const Te=Ee({},[["render",function(e,a){return t(),g("div",null," Not Found ")}]]),$e=Object.freeze(Object.defineProperty({__proto__:null,default:Te},Symbol.toStringTag,{value:"Module"}));
